// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.28.0
// source: agriculture_listing.sql

package sqlc

import (
	"context"
	"time"

	"github.com/jackc/pgx/v5/pgtype"
)

const filterAgriculturalProperties = `-- name: FilterAgriculturalProperties :many
With x As(
 SELECT agricultural_freelancer_properties.id, agricultural_freelancer_properties.property_title,agricultural_freelancer_properties.property_name, agricultural_freelancer_properties.property_title_arabic, agricultural_freelancer_properties.description, agricultural_freelancer_properties.description_arabic, agricultural_freelancer_properties.is_verified, agricultural_freelancer_properties.property_rank, agricultural_freelancer_properties.addresses_id, agricultural_freelancer_properties.locations_id, agricultural_freelancer_properties.property_types_id, agricultural_freelancer_properties.facilities_id, agricultural_freelancer_properties.amenities_id, agricultural_freelancer_properties.status, agricultural_freelancer_properties.created_at AS created_time, agricultural_freelancer_properties.updated_at, agricultural_freelancer_properties.is_show_owner_info, agricultural_freelancer_properties.property, agricultural_freelancer_properties.countries_id, agricultural_freelancer_properties.ref_no,agricultural_freelancer_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_freelancer_properties
 LEFT JOIN addresses ON agricultural_freelancer_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_freelancer_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_freelancer_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 2
 LEFT JOIN agricultural_freelancer_properties_media ON agricultural_freelancer_properties.id = agricultural_freelancer_properties_media.id
 WHERE 
        addresses.countries_id = $4::bigint
	--         -- city
	AND cities.city ILIKE $5::varchar
	
	AND LOWER(agricultural_freelancer_properties.category)
	ILIKE $6::varchar
	--         -- category or type
	AND property_types.type ILIKE $7::varchar
		--  reference number
    AND ($8::varchar = '%%'
		OR  agricultural_freelancer_properties.ref_no ILIKE $8::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $9::bigint
		AND $10::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($11::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($11::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($12::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($12::bigint []))
	--      	-- completion status
	AND CASE WHEN $13::bigint IS NULL THEN
		TRUE
	WHEN $13::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $13::bigint
	END
	--  ownership
	AND CASE WHEN $14::bigint IS NULL THEN
		TRUE
	WHEN $14::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $14::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $15::float
		END
		-- max plot area
		AND CASE WHEN $16::float IS NULL THEN
			TRUE
		WHEN $16::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $16::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $17::float IS NULL THEN
			TRUE
		WHEN $17::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $17::float
		END
		-- max builup area
		AND CASE WHEN $18::float IS NULL THEN
			TRUE
		WHEN $18::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $18::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $19::bigint IS NULL THEN
		TRUE
	WHEN $19::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $19::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($20::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($20::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $21::bigint IS NULL THEN
			TRUE
		WHEN $21::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $21::bigint
		END
		-- max service charges
		AND CASE WHEN $22::bigint IS NULL THEN
			TRUE
		WHEN $22::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $22::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($23::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $23::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($24::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $24::bigint []
		END)
	-- media
	AND($25::bigint = 0
		OR(array_length(agricultural_freelancer_properties_media.image_url,
				$26) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.image360_url,
				$27) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.video_url,
				$28) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.panaroma_url,
				$29) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($30::bigint [],
			1) IS NULL
		OR agricultural_freelancer_properties.property_rank = ANY ($30::bigint []))
	AND(communities.community ILIKE $31::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $32::varchar
		OR sub_communities.sub_community IS NULL)
	AND($33::bool IS NULL
		OR agricultural_freelancer_properties.is_verified = $33::bool)
	--  search purpose
	AND(
		CASE WHEN $34::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_freelancer_properties.property_title ILIKE $34::varchar
			OR agricultural_freelancer_properties.property_title_arabic ILIKE $34::varchar
			OR property_types.type ILIKE $34::varchar
			OR cities.city ILIKE $34::varchar
			OR communities.community ILIKE $34::varchar
			OR sub_communities.sub_community ILIKE $34::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_freelancer_properties.status != 5
	AND agricultural_freelancer_properties.status != 6
           UNION ALL
 SELECT agricultural_owner_properties.id, agricultural_owner_properties.property_title,agricultural_owner_properties.property_name, agricultural_owner_properties.property_title_arabic, agricultural_owner_properties.description, agricultural_owner_properties.description_arabic, agricultural_owner_properties.is_verified, agricultural_owner_properties.property_rank, agricultural_owner_properties.addresses_id, agricultural_owner_properties.locations_id, agricultural_owner_properties.property_types_id, agricultural_owner_properties.facilities_id, agricultural_owner_properties.amenities_id, agricultural_owner_properties.status, agricultural_owner_properties.created_at AS created_time, agricultural_owner_properties.updated_at, agricultural_owner_properties.is_show_owner_info, agricultural_owner_properties.property, agricultural_owner_properties.countries_id, agricultural_owner_properties.ref_no,agricultural_owner_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_owner_properties
 LEFT JOIN addresses ON agricultural_owner_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_owner_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_owner_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 4
 LEFT JOIN agricultural_owner_properties_media ON agricultural_owner_properties.id = agricultural_owner_properties_media.id
 WHERE 
        addresses.countries_id = $4::bigint
	--         -- city
	AND cities.city ILIKE $5::varchar
	--         -- section
	AND LOWER(agricultural_owner_properties.category)
	ILIKE $6::varchar
	--         -- category or type
	AND property_types.type ILIKE $7::varchar
		--  reference number
    AND ($8::varchar = '%%'
		OR  agricultural_owner_properties.ref_no ILIKE $8::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $9::bigint
		AND $10::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($11::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($11::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($12::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($12::bigint []))
	--      	-- completion status
	AND CASE WHEN $13::bigint IS NULL THEN
		TRUE
	WHEN $13::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $13::bigint
	END
	--  ownership
	AND CASE WHEN $14::bigint IS NULL THEN
		TRUE
	WHEN $14::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $14::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $15::float
		END
		-- max plot area
		AND CASE WHEN $16::float IS NULL THEN
			TRUE
		WHEN $16::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $16::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $17::float IS NULL THEN
			TRUE
		WHEN $17::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $17::float
		END
		-- max builup area
		AND CASE WHEN $18::float IS NULL THEN
			TRUE
		WHEN $18::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $18::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $19::bigint IS NULL THEN
		TRUE
	WHEN $19::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $19::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($20::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($20::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $21::bigint IS NULL THEN
			TRUE
		WHEN $21::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $21::bigint
		END
		-- max service charges
		AND CASE WHEN $22::bigint IS NULL THEN
			TRUE
		WHEN $22::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $22::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($23::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $23::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($24::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $24::bigint []
		END)
	-- media
	AND($25::bigint = 0
		OR(array_length(agricultural_owner_properties_media.image_url,
				$26) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.image360_url,
				$27) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.video_url,
				$28) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.panaroma_url,
				$29) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($30::bigint [],
			1) IS NULL
		OR agricultural_owner_properties.property_rank = ANY ($30::bigint []))
	AND(communities.community ILIKE $31::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $32::varchar
		OR sub_communities.sub_community IS NULL)
	AND($33::bool IS NULL
		OR agricultural_owner_properties.is_verified = $33::bool)
	--  search purpose
	AND(
		CASE WHEN $34::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_owner_properties.property_title ILIKE $34::varchar
			OR agricultural_owner_properties.property_title_arabic ILIKE $34::varchar
			OR property_types.type ILIKE $34::varchar
			OR cities.city ILIKE $34::varchar
			OR communities.community ILIKE $34::varchar
			OR sub_communities.sub_community ILIKE $34::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_owner_properties.status != 5
	AND agricultural_owner_properties.status != 6
                   UNION ALL 
 SELECT agricultural_broker_agent_properties.id, agricultural_broker_agent_properties.property_title,agricultural_broker_agent_properties.property_name, agricultural_broker_agent_properties.property_title_arabic, agricultural_broker_agent_properties.description, agricultural_broker_agent_properties.description_arabic, agricultural_broker_agent_properties.is_verified, agricultural_broker_agent_properties.property_rank, agricultural_broker_agent_properties.addresses_id, agricultural_broker_agent_properties.locations_id, agricultural_broker_agent_properties.property_types_id, agricultural_broker_agent_properties.facilities_id, agricultural_broker_agent_properties.amenities_id, agricultural_broker_agent_properties.status, agricultural_broker_agent_properties.created_at AS created_time, agricultural_broker_agent_properties.updated_at, agricultural_broker_agent_properties.is_show_owner_info, agricultural_broker_agent_properties.property, agricultural_broker_agent_properties.countries_id, agricultural_broker_agent_properties.ref_no,agricultural_broker_agent_properties.users_id, agricultural_broker_agent_properties.is_branch, broker_company_agents, agricultural_broker_agent_properties.broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties
 LEFT JOIN addresses ON agricultural_broker_agent_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_agents ON agricultural_broker_agent_properties.broker_company_agents = broker_company_agents.id
 LEFT JOIN users ON broker_company_agents.users_id = users.id
 LEFT JOIN broker_companies ON broker_company_agents.broker_companies_id = broker_companies.id
 LEFT JOIN agricultural_broker_agent_properties_media ON agricultural_broker_agent_properties.id = agricultural_broker_agent_properties_media.id
 WHERE 
    addresses.countries_id = $4::bigint
	--         -- city
	AND cities.city ILIKE $5::varchar
	--         -- section
	AND LOWER(agricultural_broker_agent_properties.category)
	ILIKE $6::varchar
	--         -- category or type
	AND property_types.type ILIKE $7::varchar
		--  reference number
    AND ($8::varchar = '%%'
		OR  agricultural_broker_agent_properties.ref_no ILIKE $8::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $9::bigint
		AND $10::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($11::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($11::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($12::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($12::bigint []))
	--      	-- completion status
	AND CASE WHEN $13::bigint IS NULL THEN
		TRUE
	WHEN $13::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $13::bigint
	END
	--  ownership
	AND CASE WHEN $14::bigint IS NULL THEN
		TRUE
	WHEN $14::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $14::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $15::float
		END
		-- max plot area
		AND CASE WHEN $16::float IS NULL THEN
			TRUE
		WHEN $16::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $16::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $17::float IS NULL THEN
			TRUE
		WHEN $17::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $17::float
		END
		-- max builup area
		AND CASE WHEN $18::float IS NULL THEN
			TRUE
		WHEN $18::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $18::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $19::bigint IS NULL THEN
		TRUE
	WHEN $19::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $19::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($20::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($20::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $21::bigint IS NULL THEN
			TRUE
		WHEN $21::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $21::bigint
		END
		-- max service charges
		AND CASE WHEN $22::bigint IS NULL THEN
			TRUE
		WHEN $22::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $22::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($23::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $23::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($24::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $24::bigint []
		END)
	-- media
	AND($25::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_media.image_url,
				$26) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.image360_url,
				$27) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.video_url,
				$28) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.panaroma_url,
				$29) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($35::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($35::varchar))
	OR($35::varchar = '%%'
		OR LOWER(broker_companies.company_name)
		ILIKE LOWER($35::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($30::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties.property_rank = ANY ($30::bigint []))
	AND(communities.community ILIKE $31::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $32::varchar
		OR sub_communities.sub_community IS NULL)
	AND($33::bool IS NULL
		OR agricultural_broker_agent_properties.is_verified = $33::bool)
	--  search purpose
	AND(
		CASE WHEN $34::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties.property_title ILIKE $34::varchar
			OR agricultural_broker_agent_properties.property_title_arabic ILIKE $34::varchar
			OR property_types.type ILIKE $34::varchar
			OR cities.city ILIKE $34::varchar
			OR communities.community ILIKE $34::varchar
			OR sub_communities.sub_community ILIKE $34::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties.status != 5
	AND agricultural_broker_agent_properties.status != 6
        UNION ALL 
 SELECT agricultural_broker_agent_properties_branch.id, agricultural_broker_agent_properties_branch.property_title,agricultural_broker_agent_properties_branch.property_name, agricultural_broker_agent_properties_branch.property_title_arabic, agricultural_broker_agent_properties_branch.description, agricultural_broker_agent_properties_branch.description_arabic, agricultural_broker_agent_properties_branch.is_verified, agricultural_broker_agent_properties_branch.property_rank, agricultural_broker_agent_properties_branch.addresses_id, agricultural_broker_agent_properties_branch.locations_id, agricultural_broker_agent_properties_branch.property_types_id, agricultural_broker_agent_properties_branch.facilities_id, agricultural_broker_agent_properties_branch.amenities_id, agricultural_broker_agent_properties_branch.status, agricultural_broker_agent_properties_branch.created_at AS created_time, agricultural_broker_agent_properties_branch.updated_at, agricultural_broker_agent_properties_branch.is_show_owner_info, agricultural_broker_agent_properties_branch.property, agricultural_broker_agent_properties_branch.countries_id, agricultural_broker_agent_properties_branch.ref_no,agricultural_broker_agent_properties_branch.users_id, agricultural_broker_agent_properties_branch.is_branch,agricultural_broker_agent_properties_branch.broker_company_branches_agents AS broker_company_agents, agricultural_broker_agent_properties_branch.broker_companies_branches_id AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties_branch 
 LEFT JOIN addresses ON agricultural_broker_agent_properties_branch.addresses_id = addresses.id
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties_branch.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties_branch.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_branches_agents ON agricultural_broker_agent_properties_branch.broker_company_branches_agents = broker_company_branches_agents.id
 LEFT JOIN users ON broker_company_branches_agents.users_id = users.id
 LEFT JOIN broker_companies_branches ON broker_company_branches_agents.broker_companies_branches_id = broker_companies_branches.id
 LEFT JOIN agricultural_broker_agent_properties_branch_media ON agricultural_broker_agent_properties_branch.id = agricultural_broker_agent_properties_branch_media.id

 WHERE 
    addresses.countries_id = $4::bigint
	--         -- city
	AND cities.city ILIKE $5::varchar
	--         -- section
	AND LOWER(agricultural_broker_agent_properties_branch.category)
	ILIKE $6::varchar
	--         -- category or type
	AND property_types.type ILIKE $7::varchar
		--  reference number
    AND ($8::varchar = '%%'
		OR  agricultural_broker_agent_properties_branch.ref_no ILIKE $8::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $9::bigint
		AND $10::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($11::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($11::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($12::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($12::bigint []))
	--      	-- completion status
	AND CASE WHEN $13::bigint IS NULL THEN
		TRUE
	WHEN $13::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $13::bigint
	END
	--  ownership
	AND CASE WHEN $14::bigint IS NULL THEN
		TRUE
	WHEN $14::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $14::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $15::float
		END
		-- max plot area
		AND CASE WHEN $16::float IS NULL THEN
			TRUE
		WHEN $16::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $16::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $17::float IS NULL THEN
			TRUE
		WHEN $17::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $17::float
		END
		-- max builup area
		AND CASE WHEN $18::float IS NULL THEN
			TRUE
		WHEN $18::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $18::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $19::bigint IS NULL THEN
		TRUE
	WHEN $19::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $19::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($20::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($20::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $21::bigint IS NULL THEN
			TRUE
		WHEN $21::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $21::bigint
		END
		-- max service charges
		AND CASE WHEN $22::bigint IS NULL THEN
			TRUE
		WHEN $22::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $22::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($23::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $23::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($24::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $24::bigint []
		END)
	-- media
	AND($25::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_branch_media.image_url,
				$26) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.image360_url,
				$27) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.video_url,
				$28) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.panaroma_url,
				$29) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($35::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($35::varchar))
	OR($35::varchar = '%%'
		OR LOWER(broker_companies_branches.company_name)
		ILIKE LOWER($35::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($30::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties_branch.property_rank = ANY ($30::bigint []))
	AND(communities.community ILIKE $31::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $32::varchar
		OR sub_communities.sub_community IS NULL)
	AND($33::bool IS NULL
		OR agricultural_broker_agent_properties_branch.is_verified = $33::bool)
	--  search purpose
	AND(
		CASE WHEN $34::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties_branch.property_title ILIKE $34::varchar
			OR agricultural_broker_agent_properties_branch.property_title_arabic ILIKE $34::varchar
			OR property_types.type ILIKE $34::varchar
			OR cities.city ILIKE $34::varchar
			OR communities.community ILIKE $34::varchar
			OR sub_communities.sub_community ILIKE $34::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties_branch.status != 5
	AND agricultural_broker_agent_properties_branch.status != 6
) SELECT id,property_title,property_name,property_title_arabic,description,description_arabic,is_verified,property_rank,addresses_id,locations_id,property_types_id,facilities_id,amenities_id,status,created_time,updated_at,is_show_owner_info,property, countries_id,ref_no,users_id ,is_branch,broker_company_agents, broker_companies_id FROM x ORDER BY
   CASE WHEN $3::bigint = 5 THEN
		unit_bedroom
	END DESC NULLS LAST,
	CASE WHEN $3::bigint = 4 THEN
		unit_bedroom
	END,
	CASE WHEN $3::bigint = 3 THEN
		unit_price
	END DESC,
	CASE WHEN $3::bigint = 2 THEN
		unit_price
	END,
	CASE WHEN $3::bigint = 1 THEN
		created_time
	END DESC,
	property_rank DESC,
	is_verified DESC,
	RANDOM()
LIMIT $1 OFFSET $2
`

type FilterAgriculturalPropertiesParams struct {
	Limit             int32       `json:"limit"`
	Offset            int32       `json:"offset"`
	Rank              int64       `json:"rank"`
	CountryID         int64       `json:"country_id"`
	City              string      `json:"city"`
	CategorySection   string      `json:"category_section"`
	PropertyType      string      `json:"property_type"`
	Ref               string      `json:"ref"`
	MinPrice          int64       `json:"min_price"`
	MaxPrice          int64       `json:"max_price"`
	Bedrooms          []string    `json:"bedrooms"`
	Bathrooms         []int64     `json:"bathrooms"`
	CompletionStatus  int64       `json:"completion_status"`
	Ownership         int64       `json:"ownership"`
	MinPlotArea       float64     `json:"min_plot_area"`
	MaxPlotArea       float64     `json:"max_plot_area"`
	MinBuildupArea    float64     `json:"min_buildup_area"`
	MaxBuildupArea    float64     `json:"max_buildup_area"`
	Furnished         int64       `json:"furnished"`
	Parkings          []int64     `json:"parkings"`
	MinServiceCharges int64       `json:"min_service_charges"`
	MaxServiceCharges int64       `json:"max_service_charges"`
	Amenities         []int64     `json:"amenities"`
	Views             []int64     `json:"views"`
	Media             int64       `json:"media"`
	ImageUrl          int32       `json:"image_url"`
	Image360Url       int32       `json:"image360_url"`
	VideoUrl          int32       `json:"video_url"`
	PanaromaUrl       int32       `json:"panaroma_url"`
	UnitRank          []int64     `json:"unit_rank"`
	Community         string      `json:"community"`
	SubCommunity      string      `json:"sub_community"`
	IsVerified        pgtype.Bool `json:"is_verified"`
	Search            string      `json:"search"`
	AgentAgency       string      `json:"agent_agency"`
}

type FilterAgriculturalPropertiesRow struct {
	ID                  int64       `json:"id"`
	PropertyTitle       string      `json:"property_title"`
	PropertyName        string      `json:"property_name"`
	PropertyTitleArabic string      `json:"property_title_arabic"`
	Description         string      `json:"description"`
	DescriptionArabic   string      `json:"description_arabic"`
	IsVerified          pgtype.Bool `json:"is_verified"`
	PropertyRank        int64       `json:"property_rank"`
	AddressesID         int64       `json:"addresses_id"`
	LocationsID         int64       `json:"locations_id"`
	PropertyTypesID     int64       `json:"property_types_id"`
	FacilitiesID        []int64     `json:"facilities_id"`
	AmenitiesID         []int64     `json:"amenities_id"`
	Status              int64       `json:"status"`
	CreatedTime         time.Time   `json:"created_time"`
	UpdatedAt           time.Time   `json:"updated_at"`
	IsShowOwnerInfo     pgtype.Bool `json:"is_show_owner_info"`
	Property            int64       `json:"property"`
	CountriesID         int64       `json:"countries_id"`
	RefNo               string      `json:"ref_no"`
	UsersID             int64       `json:"users_id"`
	IsBranch            pgtype.Bool `json:"is_branch"`
	BrokerCompanyAgents pgtype.Int8 `json:"broker_company_agents"`
	BrokerCompaniesID   pgtype.Int8 `json:"broker_companies_id"`
}

func (q *Queries) FilterAgriculturalProperties(ctx context.Context, arg FilterAgriculturalPropertiesParams) ([]FilterAgriculturalPropertiesRow, error) {
	rows, err := q.db.Query(ctx, filterAgriculturalProperties,
		arg.Limit,
		arg.Offset,
		arg.Rank,
		arg.CountryID,
		arg.City,
		arg.CategorySection,
		arg.PropertyType,
		arg.Ref,
		arg.MinPrice,
		arg.MaxPrice,
		arg.Bedrooms,
		arg.Bathrooms,
		arg.CompletionStatus,
		arg.Ownership,
		arg.MinPlotArea,
		arg.MaxPlotArea,
		arg.MinBuildupArea,
		arg.MaxBuildupArea,
		arg.Furnished,
		arg.Parkings,
		arg.MinServiceCharges,
		arg.MaxServiceCharges,
		arg.Amenities,
		arg.Views,
		arg.Media,
		arg.ImageUrl,
		arg.Image360Url,
		arg.VideoUrl,
		arg.PanaromaUrl,
		arg.UnitRank,
		arg.Community,
		arg.SubCommunity,
		arg.IsVerified,
		arg.Search,
		arg.AgentAgency,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []FilterAgriculturalPropertiesRow
	for rows.Next() {
		var i FilterAgriculturalPropertiesRow
		if err := rows.Scan(
			&i.ID,
			&i.PropertyTitle,
			&i.PropertyName,
			&i.PropertyTitleArabic,
			&i.Description,
			&i.DescriptionArabic,
			&i.IsVerified,
			&i.PropertyRank,
			&i.AddressesID,
			&i.LocationsID,
			&i.PropertyTypesID,
			&i.FacilitiesID,
			&i.AmenitiesID,
			&i.Status,
			&i.CreatedTime,
			&i.UpdatedAt,
			&i.IsShowOwnerInfo,
			&i.Property,
			&i.CountriesID,
			&i.RefNo,
			&i.UsersID,
			&i.IsBranch,
			&i.BrokerCompanyAgents,
			&i.BrokerCompaniesID,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const filterCountAgriculturalProperties = `-- name: FilterCountAgriculturalProperties :many
With x As(
 SELECT agricultural_freelancer_properties.id, agricultural_freelancer_properties.property_title,agricultural_freelancer_properties.property_name, agricultural_freelancer_properties.property_title_arabic, agricultural_freelancer_properties.description, agricultural_freelancer_properties.description_arabic, agricultural_freelancer_properties.is_verified, agricultural_freelancer_properties.property_rank, agricultural_freelancer_properties.addresses_id, agricultural_freelancer_properties.locations_id, agricultural_freelancer_properties.property_types_id, agricultural_freelancer_properties.facilities_id, agricultural_freelancer_properties.amenities_id, agricultural_freelancer_properties.status, agricultural_freelancer_properties.created_at AS created_time, agricultural_freelancer_properties.updated_at, agricultural_freelancer_properties.is_show_owner_info, agricultural_freelancer_properties.property, agricultural_freelancer_properties.countries_id, agricultural_freelancer_properties.ref_no,agricultural_freelancer_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_freelancer_properties
 LEFT JOIN addresses ON agricultural_freelancer_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_freelancer_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_freelancer_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 2
 LEFT JOIN agricultural_freelancer_properties_media ON agricultural_freelancer_properties.id = agricultural_freelancer_properties_media.id
 WHERE 
        addresses.countries_id = $1::bigint
	--         -- city
	AND cities.city ILIKE $2::varchar
	
	AND LOWER(agricultural_freelancer_properties.category)
	ILIKE $3::varchar
	--         -- category or type
	AND property_types.type ILIKE $4::varchar
		--  reference number
    AND ($5::varchar = '%%'
		OR  agricultural_freelancer_properties.ref_no ILIKE $5::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $6::bigint
		AND $7::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($8::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($8::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($9::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($9::bigint []))
	--      	-- completion status
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $10::bigint
	END
	--  ownership
	AND CASE WHEN $11::bigint IS NULL THEN
		TRUE
	WHEN $11::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $11::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $12::float
		END
		-- max plot area
		AND CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $13::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $14::float
		END
		-- max builup area
		AND CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $15::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $16::bigint IS NULL THEN
		TRUE
	WHEN $16::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $16::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($17::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($17::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $18::bigint
		END
		-- max service charges
		AND CASE WHEN $19::bigint IS NULL THEN
			TRUE
		WHEN $19::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $19::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $20::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($21::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $21::bigint []
		END)
	-- media
	AND($22::bigint = 0
		OR(array_length(agricultural_freelancer_properties_media.image_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.image360_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.video_url,
				$25) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.panaroma_url,
				$26) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($27::bigint [],
			1) IS NULL
		OR agricultural_freelancer_properties.property_rank = ANY ($27::bigint []))
	AND(communities.community ILIKE $28::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $29::varchar
		OR sub_communities.sub_community IS NULL)
	AND($30::bool IS NULL
		OR agricultural_freelancer_properties.is_verified = $30::bool)
	--  search purpose
	AND(
		CASE WHEN $31::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_freelancer_properties.property_title ILIKE $31::varchar
			OR agricultural_freelancer_properties.property_title_arabic ILIKE $31::varchar
			OR property_types.type ILIKE $31::varchar
			OR cities.city ILIKE $31::varchar
			OR communities.community ILIKE $31::varchar
			OR sub_communities.sub_community ILIKE $31::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_freelancer_properties.status != 5
	AND agricultural_freelancer_properties.status != 6
           UNION ALL
 SELECT agricultural_owner_properties.id, agricultural_owner_properties.property_title,agricultural_owner_properties.property_name, agricultural_owner_properties.property_title_arabic, agricultural_owner_properties.description, agricultural_owner_properties.description_arabic, agricultural_owner_properties.is_verified, agricultural_owner_properties.property_rank, agricultural_owner_properties.addresses_id, agricultural_owner_properties.locations_id, agricultural_owner_properties.property_types_id, agricultural_owner_properties.facilities_id, agricultural_owner_properties.amenities_id, agricultural_owner_properties.status, agricultural_owner_properties.created_at AS created_time, agricultural_owner_properties.updated_at, agricultural_owner_properties.is_show_owner_info, agricultural_owner_properties.property, agricultural_owner_properties.countries_id, agricultural_owner_properties.ref_no,agricultural_owner_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_owner_properties
 LEFT JOIN addresses ON agricultural_owner_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_owner_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_owner_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 4
 LEFT JOIN agricultural_owner_properties_media ON agricultural_owner_properties.id = agricultural_owner_properties_media.id
 WHERE 
        addresses.countries_id = $1::bigint
	--         -- city
	AND cities.city ILIKE $2::varchar
	--         -- section
	AND LOWER(agricultural_owner_properties.category)
	ILIKE $3::varchar
	--         -- category or type
	AND property_types.type ILIKE $4::varchar
		--  reference number
    AND ($5::varchar = '%%'
		OR  agricultural_owner_properties.ref_no ILIKE $5::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $6::bigint
		AND $7::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($8::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($8::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($9::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($9::bigint []))
	--      	-- completion status
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $10::bigint
	END
	--  ownership
	AND CASE WHEN $11::bigint IS NULL THEN
		TRUE
	WHEN $11::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $11::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $12::float
		END
		-- max plot area
		AND CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $13::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $14::float
		END
		-- max builup area
		AND CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $15::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $16::bigint IS NULL THEN
		TRUE
	WHEN $16::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $16::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($17::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($17::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $18::bigint
		END
		-- max service charges
		AND CASE WHEN $19::bigint IS NULL THEN
			TRUE
		WHEN $19::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $19::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $20::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($21::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $21::bigint []
		END)
	-- media
	AND($22::bigint = 0
		OR(array_length(agricultural_owner_properties_media.image_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.image360_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.video_url,
				$25) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.panaroma_url,
				$26) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($27::bigint [],
			1) IS NULL
		OR agricultural_owner_properties.property_rank = ANY ($27::bigint []))
	AND(communities.community ILIKE $28::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $29::varchar
		OR sub_communities.sub_community IS NULL)
	AND($30::bool IS NULL
		OR agricultural_owner_properties.is_verified = $30::bool)
	--  search purpose
	AND(
		CASE WHEN $31::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_owner_properties.property_title ILIKE $31::varchar
			OR agricultural_owner_properties.property_title_arabic ILIKE $31::varchar
			OR property_types.type ILIKE $31::varchar
			OR cities.city ILIKE $31::varchar
			OR communities.community ILIKE $31::varchar
			OR sub_communities.sub_community ILIKE $31::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_owner_properties.status != 5
	AND agricultural_owner_properties.status != 6
                   UNION ALL 
 SELECT agricultural_broker_agent_properties.id, agricultural_broker_agent_properties.property_title,agricultural_broker_agent_properties.property_name, agricultural_broker_agent_properties.property_title_arabic, agricultural_broker_agent_properties.description, agricultural_broker_agent_properties.description_arabic, agricultural_broker_agent_properties.is_verified, agricultural_broker_agent_properties.property_rank, agricultural_broker_agent_properties.addresses_id, agricultural_broker_agent_properties.locations_id, agricultural_broker_agent_properties.property_types_id, agricultural_broker_agent_properties.facilities_id, agricultural_broker_agent_properties.amenities_id, agricultural_broker_agent_properties.status, agricultural_broker_agent_properties.created_at AS created_time, agricultural_broker_agent_properties.updated_at, agricultural_broker_agent_properties.is_show_owner_info, agricultural_broker_agent_properties.property, agricultural_broker_agent_properties.countries_id, agricultural_broker_agent_properties.ref_no,agricultural_broker_agent_properties.users_id, agricultural_broker_agent_properties.is_branch, broker_company_agents, agricultural_broker_agent_properties.broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties
 LEFT JOIN addresses ON agricultural_broker_agent_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_agents ON agricultural_broker_agent_properties.broker_company_agents = broker_company_agents.id
 LEFT JOIN users ON broker_company_agents.users_id = users.id
 LEFT JOIN broker_companies ON broker_company_agents.broker_companies_id = broker_companies.id
 LEFT JOIN agricultural_broker_agent_properties_media ON agricultural_broker_agent_properties.id = agricultural_broker_agent_properties_media.id
 WHERE 
    addresses.countries_id = $1::bigint
	--         -- city
	AND cities.city ILIKE $2::varchar
	--         -- section
	AND LOWER(agricultural_broker_agent_properties.category)
	ILIKE $3::varchar
	--         -- category or type
	AND property_types.type ILIKE $4::varchar
		--  reference number
    AND ($5::varchar = '%%'
		OR  agricultural_broker_agent_properties.ref_no ILIKE $5::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $6::bigint
		AND $7::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($8::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($8::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($9::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($9::bigint []))
	--      	-- completion status
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $10::bigint
	END
	--  ownership
	AND CASE WHEN $11::bigint IS NULL THEN
		TRUE
	WHEN $11::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $11::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $12::float
		END
		-- max plot area
		AND CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $13::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $14::float
		END
		-- max builup area
		AND CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $15::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $16::bigint IS NULL THEN
		TRUE
	WHEN $16::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $16::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($17::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($17::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $18::bigint
		END
		-- max service charges
		AND CASE WHEN $19::bigint IS NULL THEN
			TRUE
		WHEN $19::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $19::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $20::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($21::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $21::bigint []
		END)
	-- media
	AND($22::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_media.image_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.image360_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.video_url,
				$25) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.panaroma_url,
				$26) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($32::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($32::varchar))
	OR($32::varchar = '%%'
		OR LOWER(broker_companies.company_name)
		ILIKE LOWER($32::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($27::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties.property_rank = ANY ($27::bigint []))
	AND(communities.community ILIKE $28::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $29::varchar
		OR sub_communities.sub_community IS NULL)
	AND($30::bool IS NULL
		OR agricultural_broker_agent_properties.is_verified = $30::bool)
	--  search purpose
	AND(
		CASE WHEN $31::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties.property_title ILIKE $31::varchar
			OR agricultural_broker_agent_properties.property_title_arabic ILIKE $31::varchar
			OR property_types.type ILIKE $31::varchar
			OR cities.city ILIKE $31::varchar
			OR communities.community ILIKE $31::varchar
			OR sub_communities.sub_community ILIKE $31::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties.status != 5
	AND agricultural_broker_agent_properties.status != 6
        UNION ALL 
 SELECT agricultural_broker_agent_properties_branch.id, agricultural_broker_agent_properties_branch.property_title,agricultural_broker_agent_properties_branch.property_name, agricultural_broker_agent_properties_branch.property_title_arabic, agricultural_broker_agent_properties_branch.description, agricultural_broker_agent_properties_branch.description_arabic, agricultural_broker_agent_properties_branch.is_verified, agricultural_broker_agent_properties_branch.property_rank, agricultural_broker_agent_properties_branch.addresses_id, agricultural_broker_agent_properties_branch.locations_id, agricultural_broker_agent_properties_branch.property_types_id, agricultural_broker_agent_properties_branch.facilities_id, agricultural_broker_agent_properties_branch.amenities_id, agricultural_broker_agent_properties_branch.status, agricultural_broker_agent_properties_branch.created_at AS created_time, agricultural_broker_agent_properties_branch.updated_at, agricultural_broker_agent_properties_branch.is_show_owner_info, agricultural_broker_agent_properties_branch.property, agricultural_broker_agent_properties_branch.countries_id, agricultural_broker_agent_properties_branch.ref_no,agricultural_broker_agent_properties_branch.users_id, agricultural_broker_agent_properties_branch.is_branch,agricultural_broker_agent_properties_branch.broker_company_branches_agents AS broker_company_agents, agricultural_broker_agent_properties_branch.broker_companies_branches_id AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties_branch 
 LEFT JOIN addresses ON agricultural_broker_agent_properties_branch.addresses_id = addresses.id
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties_branch.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties_branch.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_branches_agents ON agricultural_broker_agent_properties_branch.broker_company_branches_agents = broker_company_branches_agents.id
 LEFT JOIN users ON broker_company_branches_agents.users_id = users.id
 LEFT JOIN broker_companies_branches ON broker_company_branches_agents.broker_companies_branches_id = broker_companies_branches.id
 LEFT JOIN agricultural_broker_agent_properties_branch_media ON agricultural_broker_agent_properties_branch.id = agricultural_broker_agent_properties_branch_media.id

 WHERE 
    addresses.countries_id = $1::bigint
	--         -- city
	AND cities.city ILIKE $2::varchar
	--         -- section
	AND LOWER(agricultural_broker_agent_properties_branch.category)
	ILIKE $3::varchar
	--         -- category or type
	AND property_types.type ILIKE $4::varchar
		--  reference number
    AND ($5::varchar = '%%'
		OR  agricultural_broker_agent_properties_branch.ref_no ILIKE $5::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $6::bigint
		AND $7::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($8::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($8::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($9::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($9::bigint []))
	--      	-- completion status
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $10::bigint
	END
	--  ownership
	AND CASE WHEN $11::bigint IS NULL THEN
		TRUE
	WHEN $11::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $11::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $12::float
		END
		-- max plot area
		AND CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $13::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $14::float
		END
		-- max builup area
		AND CASE WHEN $15::float IS NULL THEN
			TRUE
		WHEN $15::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $15::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $16::bigint IS NULL THEN
		TRUE
	WHEN $16::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $16::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($17::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($17::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $18::bigint
		END
		-- max service charges
		AND CASE WHEN $19::bigint IS NULL THEN
			TRUE
		WHEN $19::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $19::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $20::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($21::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $21::bigint []
		END)
	-- media
	AND($22::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_branch_media.image_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.image360_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.video_url,
				$25) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.panaroma_url,
				$26) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($32::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($32::varchar))
	OR($32::varchar = '%%'
		OR LOWER(broker_companies_branches.company_name)
		ILIKE LOWER($32::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($27::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties_branch.property_rank = ANY ($27::bigint []))
	AND(communities.community ILIKE $28::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $29::varchar
		OR sub_communities.sub_community IS NULL)
	AND($30::bool IS NULL
		OR agricultural_broker_agent_properties_branch.is_verified = $30::bool)
	--  search purpose
	AND(
		CASE WHEN $31::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties_branch.property_title ILIKE $31::varchar
			OR agricultural_broker_agent_properties_branch.property_title_arabic ILIKE $31::varchar
			OR property_types.type ILIKE $31::varchar
			OR cities.city ILIKE $31::varchar
			OR communities.community ILIKE $31::varchar
			OR sub_communities.sub_community ILIKE $31::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties_branch.status != 5
	AND agricultural_broker_agent_properties_branch.status != 6
) SELECT count(*) FROM x
`

type FilterCountAgriculturalPropertiesParams struct {
	CountryID         int64       `json:"country_id"`
	City              string      `json:"city"`
	CategorySection   string      `json:"category_section"`
	PropertyType      string      `json:"property_type"`
	Ref               string      `json:"ref"`
	MinPrice          int64       `json:"min_price"`
	MaxPrice          int64       `json:"max_price"`
	Bedrooms          []string    `json:"bedrooms"`
	Bathrooms         []int64     `json:"bathrooms"`
	CompletionStatus  int64       `json:"completion_status"`
	Ownership         int64       `json:"ownership"`
	MinPlotArea       float64     `json:"min_plot_area"`
	MaxPlotArea       float64     `json:"max_plot_area"`
	MinBuildupArea    float64     `json:"min_buildup_area"`
	MaxBuildupArea    float64     `json:"max_buildup_area"`
	Furnished         int64       `json:"furnished"`
	Parkings          []int64     `json:"parkings"`
	MinServiceCharges int64       `json:"min_service_charges"`
	MaxServiceCharges int64       `json:"max_service_charges"`
	Amenities         []int64     `json:"amenities"`
	Views             []int64     `json:"views"`
	Media             int64       `json:"media"`
	ImageUrl          int32       `json:"image_url"`
	Image360Url       int32       `json:"image360_url"`
	VideoUrl          int32       `json:"video_url"`
	PanaromaUrl       int32       `json:"panaroma_url"`
	UnitRank          []int64     `json:"unit_rank"`
	Community         string      `json:"community"`
	SubCommunity      string      `json:"sub_community"`
	IsVerified        pgtype.Bool `json:"is_verified"`
	Search            string      `json:"search"`
	AgentAgency       string      `json:"agent_agency"`
}

func (q *Queries) FilterCountAgriculturalProperties(ctx context.Context, arg FilterCountAgriculturalPropertiesParams) ([]int64, error) {
	rows, err := q.db.Query(ctx, filterCountAgriculturalProperties,
		arg.CountryID,
		arg.City,
		arg.CategorySection,
		arg.PropertyType,
		arg.Ref,
		arg.MinPrice,
		arg.MaxPrice,
		arg.Bedrooms,
		arg.Bathrooms,
		arg.CompletionStatus,
		arg.Ownership,
		arg.MinPlotArea,
		arg.MaxPlotArea,
		arg.MinBuildupArea,
		arg.MaxBuildupArea,
		arg.Furnished,
		arg.Parkings,
		arg.MinServiceCharges,
		arg.MaxServiceCharges,
		arg.Amenities,
		arg.Views,
		arg.Media,
		arg.ImageUrl,
		arg.Image360Url,
		arg.VideoUrl,
		arg.PanaromaUrl,
		arg.UnitRank,
		arg.Community,
		arg.SubCommunity,
		arg.IsVerified,
		arg.Search,
		arg.AgentAgency,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []int64
	for rows.Next() {
		var count int64
		if err := rows.Scan(&count); err != nil {
			return nil, err
		}
		items = append(items, count)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getCountCommunityAgricultureProperties = `-- name: GetCountCommunityAgricultureProperties :one
With x As(
 SELECT agricultural_freelancer_properties.id, agricultural_freelancer_properties.property_title,agricultural_freelancer_properties.property_name, agricultural_freelancer_properties.property_title_arabic, agricultural_freelancer_properties.description, agricultural_freelancer_properties.description_arabic, agricultural_freelancer_properties.is_verified, agricultural_freelancer_properties.property_rank, agricultural_freelancer_properties.addresses_id, agricultural_freelancer_properties.locations_id, agricultural_freelancer_properties.property_types_id, agricultural_freelancer_properties.facilities_id, agricultural_freelancer_properties.amenities_id, agricultural_freelancer_properties.status, agricultural_freelancer_properties.created_at AS created_time, agricultural_freelancer_properties.updated_at, agricultural_freelancer_properties.is_show_owner_info, agricultural_freelancer_properties.property, agricultural_freelancer_properties.countries_id, agricultural_freelancer_properties.ref_no,agricultural_freelancer_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_freelancer_properties
 LEFT JOIN addresses ON agricultural_freelancer_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_freelancer_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_freelancer_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 2
 LEFT JOIN agricultural_freelancer_properties_media ON agricultural_freelancer_properties.id = agricultural_freelancer_properties_media.id
 WHERE 
   addresses.communities_id = $1::bigint
	
	AND LOWER(agricultural_freelancer_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_freelancer_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_freelancer_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_freelancer_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_freelancer_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_freelancer_properties.property_title ILIKE $30::varchar
			OR agricultural_freelancer_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_freelancer_properties.status != 5
	AND agricultural_freelancer_properties.status != 6
           UNION ALL
 SELECT agricultural_owner_properties.id, agricultural_owner_properties.property_title,agricultural_owner_properties.property_name, agricultural_owner_properties.property_title_arabic, agricultural_owner_properties.description, agricultural_owner_properties.description_arabic, agricultural_owner_properties.is_verified, agricultural_owner_properties.property_rank, agricultural_owner_properties.addresses_id, agricultural_owner_properties.locations_id, agricultural_owner_properties.property_types_id, agricultural_owner_properties.facilities_id, agricultural_owner_properties.amenities_id, agricultural_owner_properties.status, agricultural_owner_properties.created_at AS created_time, agricultural_owner_properties.updated_at, agricultural_owner_properties.is_show_owner_info, agricultural_owner_properties.property, agricultural_owner_properties.countries_id, agricultural_owner_properties.ref_no,agricultural_owner_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_owner_properties
 LEFT JOIN addresses ON agricultural_owner_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_owner_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_owner_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 4
 LEFT JOIN agricultural_owner_properties_media ON agricultural_owner_properties.id = agricultural_owner_properties_media.id
 WHERE 
     addresses.communities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_owner_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_owner_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_owner_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_owner_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_owner_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_owner_properties.property_title ILIKE $30::varchar
			OR agricultural_owner_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_owner_properties.status != 5
	AND agricultural_owner_properties.status != 6
                   UNION ALL 
 SELECT agricultural_broker_agent_properties.id, agricultural_broker_agent_properties.property_title,agricultural_broker_agent_properties.property_name, agricultural_broker_agent_properties.property_title_arabic, agricultural_broker_agent_properties.description, agricultural_broker_agent_properties.description_arabic, agricultural_broker_agent_properties.is_verified, agricultural_broker_agent_properties.property_rank, agricultural_broker_agent_properties.addresses_id, agricultural_broker_agent_properties.locations_id, agricultural_broker_agent_properties.property_types_id, agricultural_broker_agent_properties.facilities_id, agricultural_broker_agent_properties.amenities_id, agricultural_broker_agent_properties.status, agricultural_broker_agent_properties.created_at AS created_time, agricultural_broker_agent_properties.updated_at, agricultural_broker_agent_properties.is_show_owner_info, agricultural_broker_agent_properties.property, agricultural_broker_agent_properties.countries_id, agricultural_broker_agent_properties.ref_no,agricultural_broker_agent_properties.users_id, agricultural_broker_agent_properties.is_branch, broker_company_agents, agricultural_broker_agent_properties.broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties
 LEFT JOIN addresses ON agricultural_broker_agent_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_agents ON agricultural_broker_agent_properties.broker_company_agents = broker_company_agents.id
 LEFT JOIN users ON broker_company_agents.users_id = users.id
 LEFT JOIN broker_companies ON broker_company_agents.broker_companies_id = broker_companies.id
 LEFT JOIN agricultural_broker_agent_properties_media ON agricultural_broker_agent_properties.id = agricultural_broker_agent_properties_media.id
 WHERE 
    addresses.communities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties.status != 5
	AND agricultural_broker_agent_properties.status != 6
        UNION ALL 
 SELECT agricultural_broker_agent_properties_branch.id, agricultural_broker_agent_properties_branch.property_title,agricultural_broker_agent_properties_branch.property_name, agricultural_broker_agent_properties_branch.property_title_arabic, agricultural_broker_agent_properties_branch.description, agricultural_broker_agent_properties_branch.description_arabic, agricultural_broker_agent_properties_branch.is_verified, agricultural_broker_agent_properties_branch.property_rank, agricultural_broker_agent_properties_branch.addresses_id, agricultural_broker_agent_properties_branch.locations_id, agricultural_broker_agent_properties_branch.property_types_id, agricultural_broker_agent_properties_branch.facilities_id, agricultural_broker_agent_properties_branch.amenities_id, agricultural_broker_agent_properties_branch.status, agricultural_broker_agent_properties_branch.created_at AS created_time, agricultural_broker_agent_properties_branch.updated_at, agricultural_broker_agent_properties_branch.is_show_owner_info, agricultural_broker_agent_properties_branch.property, agricultural_broker_agent_properties_branch.countries_id, agricultural_broker_agent_properties_branch.ref_no,agricultural_broker_agent_properties_branch.users_id, agricultural_broker_agent_properties_branch.is_branch,agricultural_broker_agent_properties_branch.broker_company_branches_agents AS broker_company_agents, agricultural_broker_agent_properties_branch.broker_companies_branches_id AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties_branch 
 LEFT JOIN addresses ON agricultural_broker_agent_properties_branch.addresses_id = addresses.id
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties_branch.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties_branch.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_branches_agents ON agricultural_broker_agent_properties_branch.broker_company_branches_agents = broker_company_branches_agents.id
 LEFT JOIN users ON broker_company_branches_agents.users_id = users.id
 LEFT JOIN broker_companies_branches ON broker_company_branches_agents.broker_companies_branches_id = broker_companies_branches.id
 LEFT JOIN agricultural_broker_agent_properties_branch_media ON agricultural_broker_agent_properties_branch.id = agricultural_broker_agent_properties_branch_media.id
 WHERE 
  addresses.communities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties_branch.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties_branch.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_branch_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies_branches.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties_branch.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties_branch.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties_branch.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties_branch.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties_branch.status != 5
	AND agricultural_broker_agent_properties_branch.status != 6
) SELECT count(*) FROM x
`

type GetCountCommunityAgriculturePropertiesParams struct {
	CommunitiesID     int64       `json:"communities_id"`
	CategorySection   string      `json:"category_section"`
	PropertyType      string      `json:"property_type"`
	Ref               string      `json:"ref"`
	MinPrice          int64       `json:"min_price"`
	MaxPrice          int64       `json:"max_price"`
	Bedrooms          []string    `json:"bedrooms"`
	Bathrooms         []int64     `json:"bathrooms"`
	CompletionStatus  int64       `json:"completion_status"`
	Ownership         int64       `json:"ownership"`
	MinPlotArea       float64     `json:"min_plot_area"`
	MaxPlotArea       float64     `json:"max_plot_area"`
	MinBuildupArea    float64     `json:"min_buildup_area"`
	MaxBuildupArea    float64     `json:"max_buildup_area"`
	Furnished         int64       `json:"furnished"`
	Parkings          []int64     `json:"parkings"`
	MinServiceCharges int64       `json:"min_service_charges"`
	MaxServiceCharges int64       `json:"max_service_charges"`
	Amenities         []int64     `json:"amenities"`
	Views             []int64     `json:"views"`
	Media             int64       `json:"media"`
	ImageUrl          int32       `json:"image_url"`
	Image360Url       int32       `json:"image360_url"`
	VideoUrl          int32       `json:"video_url"`
	PanaromaUrl       int32       `json:"panaroma_url"`
	UnitRank          []int64     `json:"unit_rank"`
	Community         string      `json:"community"`
	SubCommunity      string      `json:"sub_community"`
	IsVerified        pgtype.Bool `json:"is_verified"`
	Search            string      `json:"search"`
	AgentAgency       string      `json:"agent_agency"`
}

func (q *Queries) GetCountCommunityAgricultureProperties(ctx context.Context, arg GetCountCommunityAgriculturePropertiesParams) (int64, error) {
	row := q.db.QueryRow(ctx, getCountCommunityAgricultureProperties,
		arg.CommunitiesID,
		arg.CategorySection,
		arg.PropertyType,
		arg.Ref,
		arg.MinPrice,
		arg.MaxPrice,
		arg.Bedrooms,
		arg.Bathrooms,
		arg.CompletionStatus,
		arg.Ownership,
		arg.MinPlotArea,
		arg.MaxPlotArea,
		arg.MinBuildupArea,
		arg.MaxBuildupArea,
		arg.Furnished,
		arg.Parkings,
		arg.MinServiceCharges,
		arg.MaxServiceCharges,
		arg.Amenities,
		arg.Views,
		arg.Media,
		arg.ImageUrl,
		arg.Image360Url,
		arg.VideoUrl,
		arg.PanaromaUrl,
		arg.UnitRank,
		arg.Community,
		arg.SubCommunity,
		arg.IsVerified,
		arg.Search,
		arg.AgentAgency,
	)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getCountStateAgricultureProperties = `-- name: GetCountStateAgricultureProperties :one
With x As(
 SELECT agricultural_freelancer_properties.id, agricultural_freelancer_properties.property_title,agricultural_freelancer_properties.property_name, agricultural_freelancer_properties.property_title_arabic, agricultural_freelancer_properties.description, agricultural_freelancer_properties.description_arabic, agricultural_freelancer_properties.is_verified, agricultural_freelancer_properties.property_rank, agricultural_freelancer_properties.addresses_id, agricultural_freelancer_properties.locations_id, agricultural_freelancer_properties.property_types_id, agricultural_freelancer_properties.facilities_id, agricultural_freelancer_properties.amenities_id, agricultural_freelancer_properties.status, agricultural_freelancer_properties.created_at AS created_time, agricultural_freelancer_properties.updated_at, agricultural_freelancer_properties.is_show_owner_info, agricultural_freelancer_properties.property, agricultural_freelancer_properties.countries_id, agricultural_freelancer_properties.ref_no,agricultural_freelancer_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_freelancer_properties
 LEFT JOIN addresses ON agricultural_freelancer_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_freelancer_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_freelancer_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 2
 LEFT JOIN agricultural_freelancer_properties_media ON agricultural_freelancer_properties.id = agricultural_freelancer_properties_media.id
 WHERE 
   addresses.cities_id = $1::bigint
	
	AND LOWER(agricultural_freelancer_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_freelancer_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_freelancer_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_freelancer_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_freelancer_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_freelancer_properties.property_title ILIKE $30::varchar
			OR agricultural_freelancer_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_freelancer_properties.status != 5
	AND agricultural_freelancer_properties.status != 6
           UNION ALL
 SELECT agricultural_owner_properties.id, agricultural_owner_properties.property_title,agricultural_owner_properties.property_name, agricultural_owner_properties.property_title_arabic, agricultural_owner_properties.description, agricultural_owner_properties.description_arabic, agricultural_owner_properties.is_verified, agricultural_owner_properties.property_rank, agricultural_owner_properties.addresses_id, agricultural_owner_properties.locations_id, agricultural_owner_properties.property_types_id, agricultural_owner_properties.facilities_id, agricultural_owner_properties.amenities_id, agricultural_owner_properties.status, agricultural_owner_properties.created_at AS created_time, agricultural_owner_properties.updated_at, agricultural_owner_properties.is_show_owner_info, agricultural_owner_properties.property, agricultural_owner_properties.countries_id, agricultural_owner_properties.ref_no,agricultural_owner_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_owner_properties
 LEFT JOIN addresses ON agricultural_owner_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_owner_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_owner_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 4
 LEFT JOIN agricultural_owner_properties_media ON agricultural_owner_properties.id = agricultural_owner_properties_media.id
 WHERE 
     addresses.cities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_owner_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_owner_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_owner_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_owner_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_owner_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_owner_properties.property_title ILIKE $30::varchar
			OR agricultural_owner_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_owner_properties.status != 5
	AND agricultural_owner_properties.status != 6
                   UNION ALL 
 SELECT agricultural_broker_agent_properties.id, agricultural_broker_agent_properties.property_title,agricultural_broker_agent_properties.property_name, agricultural_broker_agent_properties.property_title_arabic, agricultural_broker_agent_properties.description, agricultural_broker_agent_properties.description_arabic, agricultural_broker_agent_properties.is_verified, agricultural_broker_agent_properties.property_rank, agricultural_broker_agent_properties.addresses_id, agricultural_broker_agent_properties.locations_id, agricultural_broker_agent_properties.property_types_id, agricultural_broker_agent_properties.facilities_id, agricultural_broker_agent_properties.amenities_id, agricultural_broker_agent_properties.status, agricultural_broker_agent_properties.created_at AS created_time, agricultural_broker_agent_properties.updated_at, agricultural_broker_agent_properties.is_show_owner_info, agricultural_broker_agent_properties.property, agricultural_broker_agent_properties.countries_id, agricultural_broker_agent_properties.ref_no,agricultural_broker_agent_properties.users_id, agricultural_broker_agent_properties.is_branch, broker_company_agents, agricultural_broker_agent_properties.broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties
 LEFT JOIN addresses ON agricultural_broker_agent_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_agents ON agricultural_broker_agent_properties.broker_company_agents = broker_company_agents.id
 LEFT JOIN users ON broker_company_agents.users_id = users.id
 LEFT JOIN broker_companies ON broker_company_agents.broker_companies_id = broker_companies.id
 LEFT JOIN agricultural_broker_agent_properties_media ON agricultural_broker_agent_properties.id = agricultural_broker_agent_properties_media.id
 WHERE 
    addresses.cities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties.status != 5
	AND agricultural_broker_agent_properties.status != 6
        UNION ALL 
 SELECT agricultural_broker_agent_properties_branch.id, agricultural_broker_agent_properties_branch.property_title,agricultural_broker_agent_properties_branch.property_name, agricultural_broker_agent_properties_branch.property_title_arabic, agricultural_broker_agent_properties_branch.description, agricultural_broker_agent_properties_branch.description_arabic, agricultural_broker_agent_properties_branch.is_verified, agricultural_broker_agent_properties_branch.property_rank, agricultural_broker_agent_properties_branch.addresses_id, agricultural_broker_agent_properties_branch.locations_id, agricultural_broker_agent_properties_branch.property_types_id, agricultural_broker_agent_properties_branch.facilities_id, agricultural_broker_agent_properties_branch.amenities_id, agricultural_broker_agent_properties_branch.status, agricultural_broker_agent_properties_branch.created_at AS created_time, agricultural_broker_agent_properties_branch.updated_at, agricultural_broker_agent_properties_branch.is_show_owner_info, agricultural_broker_agent_properties_branch.property, agricultural_broker_agent_properties_branch.countries_id, agricultural_broker_agent_properties_branch.ref_no,agricultural_broker_agent_properties_branch.users_id, agricultural_broker_agent_properties_branch.is_branch,agricultural_broker_agent_properties_branch.broker_company_branches_agents AS broker_company_agents, agricultural_broker_agent_properties_branch.broker_companies_branches_id AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties_branch 
 LEFT JOIN addresses ON agricultural_broker_agent_properties_branch.addresses_id = addresses.id
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties_branch.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties_branch.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_branches_agents ON agricultural_broker_agent_properties_branch.broker_company_branches_agents = broker_company_branches_agents.id
 LEFT JOIN users ON broker_company_branches_agents.users_id = users.id
 LEFT JOIN broker_companies_branches ON broker_company_branches_agents.broker_companies_branches_id = broker_companies_branches.id
 LEFT JOIN agricultural_broker_agent_properties_branch_media ON agricultural_broker_agent_properties_branch.id = agricultural_broker_agent_properties_branch_media.id

 WHERE 
  addresses.cities_id = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties_branch.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties_branch.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_branch_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies_branches.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties_branch.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties_branch.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties_branch.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties_branch.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties_branch.status != 5
	AND agricultural_broker_agent_properties_branch.status != 6
) SELECT count(*) FROM x
`

type GetCountStateAgriculturePropertiesParams struct {
	CitiesID          int64       `json:"cities_id"`
	CategorySection   string      `json:"category_section"`
	PropertyType      string      `json:"property_type"`
	Ref               string      `json:"ref"`
	MinPrice          int64       `json:"min_price"`
	MaxPrice          int64       `json:"max_price"`
	Bedrooms          []string    `json:"bedrooms"`
	Bathrooms         []int64     `json:"bathrooms"`
	CompletionStatus  int64       `json:"completion_status"`
	Ownership         int64       `json:"ownership"`
	MinPlotArea       float64     `json:"min_plot_area"`
	MaxPlotArea       float64     `json:"max_plot_area"`
	MinBuildupArea    float64     `json:"min_buildup_area"`
	MaxBuildupArea    float64     `json:"max_buildup_area"`
	Furnished         int64       `json:"furnished"`
	Parkings          []int64     `json:"parkings"`
	MinServiceCharges int64       `json:"min_service_charges"`
	MaxServiceCharges int64       `json:"max_service_charges"`
	Amenities         []int64     `json:"amenities"`
	Views             []int64     `json:"views"`
	Media             int64       `json:"media"`
	ImageUrl          int32       `json:"image_url"`
	Image360Url       int32       `json:"image360_url"`
	VideoUrl          int32       `json:"video_url"`
	PanaromaUrl       int32       `json:"panaroma_url"`
	UnitRank          []int64     `json:"unit_rank"`
	Community         string      `json:"community"`
	SubCommunity      string      `json:"sub_community"`
	IsVerified        pgtype.Bool `json:"is_verified"`
	Search            string      `json:"search"`
	AgentAgency       string      `json:"agent_agency"`
}

func (q *Queries) GetCountStateAgricultureProperties(ctx context.Context, arg GetCountStateAgriculturePropertiesParams) (int64, error) {
	row := q.db.QueryRow(ctx, getCountStateAgricultureProperties,
		arg.CitiesID,
		arg.CategorySection,
		arg.PropertyType,
		arg.Ref,
		arg.MinPrice,
		arg.MaxPrice,
		arg.Bedrooms,
		arg.Bathrooms,
		arg.CompletionStatus,
		arg.Ownership,
		arg.MinPlotArea,
		arg.MaxPlotArea,
		arg.MinBuildupArea,
		arg.MaxBuildupArea,
		arg.Furnished,
		arg.Parkings,
		arg.MinServiceCharges,
		arg.MaxServiceCharges,
		arg.Amenities,
		arg.Views,
		arg.Media,
		arg.ImageUrl,
		arg.Image360Url,
		arg.VideoUrl,
		arg.PanaromaUrl,
		arg.UnitRank,
		arg.Community,
		arg.SubCommunity,
		arg.IsVerified,
		arg.Search,
		arg.AgentAgency,
	)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getCountSubCommunityAgricultureProperties = `-- name: GetCountSubCommunityAgricultureProperties :one
With x As(
 SELECT agricultural_freelancer_properties.id, agricultural_freelancer_properties.property_title,agricultural_freelancer_properties.property_name, agricultural_freelancer_properties.property_title_arabic, agricultural_freelancer_properties.description, agricultural_freelancer_properties.description_arabic, agricultural_freelancer_properties.is_verified, agricultural_freelancer_properties.property_rank, agricultural_freelancer_properties.addresses_id, agricultural_freelancer_properties.locations_id, agricultural_freelancer_properties.property_types_id, agricultural_freelancer_properties.facilities_id, agricultural_freelancer_properties.amenities_id, agricultural_freelancer_properties.status, agricultural_freelancer_properties.created_at AS created_time, agricultural_freelancer_properties.updated_at, agricultural_freelancer_properties.is_show_owner_info, agricultural_freelancer_properties.property, agricultural_freelancer_properties.countries_id, agricultural_freelancer_properties.ref_no,agricultural_freelancer_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_freelancer_properties
 LEFT JOIN addresses ON agricultural_freelancer_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_freelancer_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_freelancer_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 2
 LEFT JOIN agricultural_freelancer_properties_media ON agricultural_freelancer_properties.id = agricultural_freelancer_properties_media.id
 WHERE 
    addresses.sub_communities_id  = $1::bigint
	
	AND LOWER(agricultural_freelancer_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_freelancer_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_freelancer_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_freelancer_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_freelancer_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_freelancer_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_freelancer_properties.property_title ILIKE $30::varchar
			OR agricultural_freelancer_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_freelancer_properties.status != 5
	AND agricultural_freelancer_properties.status != 6
           UNION ALL
 SELECT agricultural_owner_properties.id, agricultural_owner_properties.property_title,agricultural_owner_properties.property_name, agricultural_owner_properties.property_title_arabic, agricultural_owner_properties.description, agricultural_owner_properties.description_arabic, agricultural_owner_properties.is_verified, agricultural_owner_properties.property_rank, agricultural_owner_properties.addresses_id, agricultural_owner_properties.locations_id, agricultural_owner_properties.property_types_id, agricultural_owner_properties.facilities_id, agricultural_owner_properties.amenities_id, agricultural_owner_properties.status, agricultural_owner_properties.created_at AS created_time, agricultural_owner_properties.updated_at, agricultural_owner_properties.is_show_owner_info, agricultural_owner_properties.property, agricultural_owner_properties.countries_id, agricultural_owner_properties.ref_no,agricultural_owner_properties.users_id, FALSE AS is_branch,0 AS broker_company_agents, 0 AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_owner_properties
 LEFT JOIN addresses ON agricultural_owner_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_owner_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_owner_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 4
 LEFT JOIN agricultural_owner_properties_media ON agricultural_owner_properties.id = agricultural_owner_properties_media.id
 WHERE 
    addresses.sub_communities_id  = $1::bigint
	--         -- section
	AND LOWER(agricultural_owner_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_owner_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_owner_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_owner_properties_media.panaroma_url,
				$25) IS NOT NULL))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_owner_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_owner_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_owner_properties.property_title ILIKE $30::varchar
			OR agricultural_owner_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_owner_properties.status != 5
	AND agricultural_owner_properties.status != 6
                   UNION ALL 
 SELECT agricultural_broker_agent_properties.id, agricultural_broker_agent_properties.property_title,agricultural_broker_agent_properties.property_name, agricultural_broker_agent_properties.property_title_arabic, agricultural_broker_agent_properties.description, agricultural_broker_agent_properties.description_arabic, agricultural_broker_agent_properties.is_verified, agricultural_broker_agent_properties.property_rank, agricultural_broker_agent_properties.addresses_id, agricultural_broker_agent_properties.locations_id, agricultural_broker_agent_properties.property_types_id, agricultural_broker_agent_properties.facilities_id, agricultural_broker_agent_properties.amenities_id, agricultural_broker_agent_properties.status, agricultural_broker_agent_properties.created_at AS created_time, agricultural_broker_agent_properties.updated_at, agricultural_broker_agent_properties.is_show_owner_info, agricultural_broker_agent_properties.property, agricultural_broker_agent_properties.countries_id, agricultural_broker_agent_properties.ref_no,agricultural_broker_agent_properties.users_id, agricultural_broker_agent_properties.is_branch, broker_company_agents, agricultural_broker_agent_properties.broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties
 LEFT JOIN addresses ON agricultural_broker_agent_properties.addresses_id = addresses.id 
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_agents ON agricultural_broker_agent_properties.broker_company_agents = broker_company_agents.id
 LEFT JOIN users ON broker_company_agents.users_id = users.id
 LEFT JOIN broker_companies ON broker_company_agents.broker_companies_id = broker_companies.id
 LEFT JOIN agricultural_broker_agent_properties_media ON agricultural_broker_agent_properties.id = agricultural_broker_agent_properties_media.id
 WHERE 
    addresses.sub_communities_id  = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties.status != 5
	AND agricultural_broker_agent_properties.status != 6
        UNION ALL 
 SELECT agricultural_broker_agent_properties_branch.id, agricultural_broker_agent_properties_branch.property_title,agricultural_broker_agent_properties_branch.property_name, agricultural_broker_agent_properties_branch.property_title_arabic, agricultural_broker_agent_properties_branch.description, agricultural_broker_agent_properties_branch.description_arabic, agricultural_broker_agent_properties_branch.is_verified, agricultural_broker_agent_properties_branch.property_rank, agricultural_broker_agent_properties_branch.addresses_id, agricultural_broker_agent_properties_branch.locations_id, agricultural_broker_agent_properties_branch.property_types_id, agricultural_broker_agent_properties_branch.facilities_id, agricultural_broker_agent_properties_branch.amenities_id, agricultural_broker_agent_properties_branch.status, agricultural_broker_agent_properties_branch.created_at AS created_time, agricultural_broker_agent_properties_branch.updated_at, agricultural_broker_agent_properties_branch.is_show_owner_info, agricultural_broker_agent_properties_branch.property, agricultural_broker_agent_properties_branch.countries_id, agricultural_broker_agent_properties_branch.ref_no,agricultural_broker_agent_properties_branch.users_id, agricultural_broker_agent_properties_branch.is_branch,agricultural_broker_agent_properties_branch.broker_company_branches_agents AS broker_company_agents, agricultural_broker_agent_properties_branch.broker_companies_branches_id AS broker_companies_id,
 agricultural_properties_facts.price AS unit_price,
 agricultural_properties_facts.bedroom AS unit_bedroom 
 from agricultural_broker_agent_properties_branch 
 LEFT JOIN addresses ON agricultural_broker_agent_properties_branch.addresses_id = addresses.id
 LEFT JOIN cities ON addresses.cities_id = cities.id
 LEFT JOIN communities ON addresses.communities_id = communities.id
 LEFT JOIN sub_communities ON addresses.sub_communities_id = sub_communities.id
 LEFT JOIN property_types ON agricultural_broker_agent_properties_branch.property_types_id = property_types.id
 LEFT JOIN agricultural_properties_facts ON agricultural_broker_agent_properties_branch.id = agricultural_properties_facts.properties_id and agricultural_properties_facts.property = 3
 LEFT JOIN broker_company_branches_agents ON agricultural_broker_agent_properties_branch.broker_company_branches_agents = broker_company_branches_agents.id
 LEFT JOIN users ON broker_company_branches_agents.users_id = users.id
 LEFT JOIN broker_companies_branches ON broker_company_branches_agents.broker_companies_branches_id = broker_companies_branches.id
 LEFT JOIN agricultural_broker_agent_properties_branch_media ON agricultural_broker_agent_properties_branch.id = agricultural_broker_agent_properties_branch_media.id

 WHERE 
    addresses.sub_communities_id  = $1::bigint
	--         -- section
	AND LOWER(agricultural_broker_agent_properties_branch.category)
	ILIKE $2::varchar
	--         -- category or type
	AND property_types.type ILIKE $3::varchar
		--  reference number
    AND ($4::varchar = '%%'
		OR  agricultural_broker_agent_properties_branch.ref_no ILIKE $4::varchar)

	--         -- price
	AND(agricultural_properties_facts.price BETWEEN $5::bigint
		AND $6::bigint)
	--         -- bedroom
	AND(ARRAY_LENGTH($7::varchar [],
			1) IS NULL
		OR agricultural_properties_facts.bedroom = ANY ($7::varchar []))
	--       	-- bathroom
	AND(ARRAY_LENGTH($8::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.bathroom = ANY ($8::bigint []))
	--      	-- completion status
	AND CASE WHEN $9::bigint IS NULL THEN
		TRUE
	WHEN $9::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.completion_status = $9::bigint
	END
	--  ownership
	AND CASE WHEN $10::bigint IS NULL THEN
		TRUE
	WHEN $10::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.ownership = $10::bigint
	END
	--     	--  plot area
	AND(
		CASE WHEN $11::float IS NULL THEN
			TRUE
		WHEN $11::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area >= $11::float
		END
		-- max plot area
		AND CASE WHEN $12::float IS NULL THEN
			TRUE
		WHEN $12::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.plot_area <= $12::float
		END)
	--         --   build-up area
	AND(
		CASE WHEN $13::float IS NULL THEN
			TRUE
		WHEN $13::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area >= $13::float
		END
		-- max builup area
		AND CASE WHEN $14::float IS NULL THEN
			TRUE
		WHEN $14::float = 0.0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.built_up_area <= $14::float
		END)
	--  	     --  furnishing
	AND CASE WHEN $15::bigint IS NULL THEN
		TRUE
	WHEN $15::bigint = 0 THEN
		TRUE
	ELSE
		agricultural_properties_facts.furnished = $15::bigint
	END
	--  	     --  Parking
	AND(ARRAY_LENGTH($16::bigint [],
			1) IS NULL
		OR agricultural_properties_facts.parking = ANY ($16::bigint []))
	--  	     --  service charges
	AND(
		CASE WHEN $17::bigint IS NULL THEN
			TRUE
		WHEN $17::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge >= $17::bigint
		END
		-- max service charges
		AND CASE WHEN $18::bigint IS NULL THEN
			TRUE
		WHEN $18::bigint = 0 THEN
			TRUE
		ELSE
			agricultural_properties_facts.service_charge <= $18::bigint
		END)
	--  amenities
	AND(
		CASE WHEN ARRAY_LENGTH($19::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			amenities_id && $19::bigint []
		END)
	--  unit views
	AND(
		CASE WHEN ARRAY_LENGTH($20::bigint [],
			1) IS NULL THEN
			TRUE
		ELSE
			agricultural_properties_facts. "view" && $20::bigint []
		END)
	-- media
	AND($21::bigint = 0
		OR(array_length(agricultural_broker_agent_properties_branch_media.image_url,
				$22) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.image360_url,
				$23) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.video_url,
				$24) IS NOT NULL)
		OR(array_length(agricultural_broker_agent_properties_branch_media.panaroma_url,
				$25) IS NOT NULL))
	--  tags or keywords
	--  todo ...
	--  agent or agency
	AND(($31::varchar = '%%'
		OR LOWER(users.username)
		ILIKE LOWER($31::varchar))
	OR($31::varchar = '%%'
		OR LOWER(broker_companies_branches.company_name)
		ILIKE LOWER($31::varchar)))
	---------------------- from here normal sale section --------------------------
	AND(ARRAY_LENGTH($26::bigint [],
			1) IS NULL
		OR agricultural_broker_agent_properties_branch.property_rank = ANY ($26::bigint []))
	AND(communities.community ILIKE $27::varchar
		OR communities.community IS NULL)
	AND(sub_communities.sub_community ILIKE $28::varchar
		OR sub_communities.sub_community IS NULL)
	AND($29::bool IS NULL
		OR agricultural_broker_agent_properties_branch.is_verified = $29::bool)
	--  search purpose
	AND(
		CASE WHEN $30::varchar IS NULL THEN
			TRUE
		ELSE
			agricultural_broker_agent_properties_branch.property_title ILIKE $30::varchar
			OR agricultural_broker_agent_properties_branch.property_title_arabic ILIKE $30::varchar
			OR property_types.type ILIKE $30::varchar
			OR cities.city ILIKE $30::varchar
			OR communities.community ILIKE $30::varchar
			OR sub_communities.sub_community ILIKE $30::varchar
		END)
	--  removing the blocked and deleted units only
	AND agricultural_broker_agent_properties_branch.status != 5
	AND agricultural_broker_agent_properties_branch.status != 6
) SELECT count(*) FROM x
`

type GetCountSubCommunityAgriculturePropertiesParams struct {
	SubCommunitiesID  int64       `json:"sub_communities_id"`
	CategorySection   string      `json:"category_section"`
	PropertyType      string      `json:"property_type"`
	Ref               string      `json:"ref"`
	MinPrice          int64       `json:"min_price"`
	MaxPrice          int64       `json:"max_price"`
	Bedrooms          []string    `json:"bedrooms"`
	Bathrooms         []int64     `json:"bathrooms"`
	CompletionStatus  int64       `json:"completion_status"`
	Ownership         int64       `json:"ownership"`
	MinPlotArea       float64     `json:"min_plot_area"`
	MaxPlotArea       float64     `json:"max_plot_area"`
	MinBuildupArea    float64     `json:"min_buildup_area"`
	MaxBuildupArea    float64     `json:"max_buildup_area"`
	Furnished         int64       `json:"furnished"`
	Parkings          []int64     `json:"parkings"`
	MinServiceCharges int64       `json:"min_service_charges"`
	MaxServiceCharges int64       `json:"max_service_charges"`
	Amenities         []int64     `json:"amenities"`
	Views             []int64     `json:"views"`
	Media             int64       `json:"media"`
	ImageUrl          int32       `json:"image_url"`
	Image360Url       int32       `json:"image360_url"`
	VideoUrl          int32       `json:"video_url"`
	PanaromaUrl       int32       `json:"panaroma_url"`
	UnitRank          []int64     `json:"unit_rank"`
	Community         string      `json:"community"`
	SubCommunity      string      `json:"sub_community"`
	IsVerified        pgtype.Bool `json:"is_verified"`
	Search            string      `json:"search"`
	AgentAgency       string      `json:"agent_agency"`
}

func (q *Queries) GetCountSubCommunityAgricultureProperties(ctx context.Context, arg GetCountSubCommunityAgriculturePropertiesParams) (int64, error) {
	row := q.db.QueryRow(ctx, getCountSubCommunityAgricultureProperties,
		arg.SubCommunitiesID,
		arg.CategorySection,
		arg.PropertyType,
		arg.Ref,
		arg.MinPrice,
		arg.MaxPrice,
		arg.Bedrooms,
		arg.Bathrooms,
		arg.CompletionStatus,
		arg.Ownership,
		arg.MinPlotArea,
		arg.MaxPlotArea,
		arg.MinBuildupArea,
		arg.MaxBuildupArea,
		arg.Furnished,
		arg.Parkings,
		arg.MinServiceCharges,
		arg.MaxServiceCharges,
		arg.Amenities,
		arg.Views,
		arg.Media,
		arg.ImageUrl,
		arg.Image360Url,
		arg.VideoUrl,
		arg.PanaromaUrl,
		arg.UnitRank,
		arg.Community,
		arg.SubCommunity,
		arg.IsVerified,
		arg.Search,
		arg.AgentAgency,
	)
	var count int64
	err := row.Scan(&count)
	return count, err
}
